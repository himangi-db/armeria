{"version":3,"file":"component---src-pages-docs-advanced-scalapb-mdx-1dc9ec01717ac9de9fdd.js","mappings":"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","sources":["webpack://armeria-site/./src/pages/docs/advanced-scalapb.mdx","webpack://armeria-site/./src/layouts/docs.tsx"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/armeria/armeria/site/src/layouts/docs.tsx\";\nimport versions from '../../../gen-src/versions.json';\nexport const pageTitle = \"ScalaPB integration\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst Tip = makeShortcode(\"Tip\");\nconst CodeBlock = makeShortcode(\"CodeBlock\");\nconst layoutProps = {\n  pageTitle,\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n\n    <h1 {...{\n      \"id\": \"scalapb-integration\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h1\" {...{\n        \"href\": \"#scalapb-integration\",\n        \"aria-label\": \"scalapb integration permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`ScalaPB integration`}</h1>\n    <h6 {...{\n      \"className\": \"inlinePageToc\",\n      \"role\": \"navigation\"\n    }}>{`Table of contents`}</h6>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><a parentName=\"p\" {...{\n            \"href\": \"#running-a-grpc-service\"\n          }}>{`Running a gRPC service`}</a></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><a parentName=\"p\" {...{\n            \"href\": \"#calling-a-grpc-service\"\n          }}>{`Calling a gRPC service`}</a></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><a parentName=\"p\" {...{\n            \"href\": \"#supporting-scalapb-in-annotated-services\"\n          }}>{`Supporting ScalaPB in annotated services.`}</a></p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><a parentName=\"li\" {...{\n              \"href\": \"#converting-an-http-request-to-a-scalapbs-generatedmesage\"\n            }}>{`Converting an HTTP request to a ScalaPB's GeneratedMesage`}</a></li>\n          <li parentName=\"ul\"><a parentName=\"li\" {...{\n              \"href\": \"#returning-a-scalapbs-generatedmesage\"\n            }}>{`Returning a ScalaPB's GeneratedMesage`}</a></li>\n          <li parentName=\"ul\"><a parentName=\"li\" {...{\n              \"href\": \"#injecting-an-executioncontext-to-an-annotated-service-method\"\n            }}>{`Injecting an ExecutionContext to an annotated service method`}</a></li>\n        </ul>\n      </li>\n    </ul>\n    <Tip mdxType=\"Tip\">\n      <p>{`Visit `}<a parentName=\"p\" {...{\n          \"href\": \"https://github.com/line/armeria/tree/master/examples/grpc-scala\"\n        }}>{`here`}</a>{` to find a fully working example.`}</p>\n    </Tip>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://scalapb.github.io/\"\n      }}>{`ScalaPB`}</a>{` is a protocol buffer compiler (protoc) plugin for\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://www.scala-lang.org/\"\n      }}>{`Scala`}</a>{`. It will generate Scala case classes, parsers and serializers for\nyour `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/protocol-buffers\"\n      }}>{`protocol buffers`}</a>{`.\nScalaPB also supports a thin wrapper around `}<a parentName=\"p\" {...{\n        \"href\": \"https://grpc.io/docs/languages/java/quickstart/\"\n      }}>{`grpc-java`}</a>{`,\nand provides you with an interface that is based on Scala's standard library\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.scala-lang.org/overviews/core/futures.html\"\n      }}>{`Future`}</a>{`,\nwhile streaming is based on the Observer pattern.\nIf you integrate ScalaPB with Armeria, you can leverage the followings:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Using both `}<a parentName=\"li\" {...{\n          \"href\": \"https://armeria.dev/docs/server-docservice\"\n        }}>{`gRPC server`}</a>{` and\n`}<a parentName=\"li\" {...{\n          \"href\": \"https://armeria.dev/docs/client-grpc\"\n        }}>{`gRPC client`}</a>{` features such as gRPC-over-HTTP/1 and\n`}<a parentName=\"li\" {...{\n          \"href\": \"gRPC-Web\"\n        }}>{`gRPC-Web`}</a>{` protocol powered by Armeria`}</li>\n      <li parentName=\"ul\">{`Browsing the list of available RPC operations and invoking a service operation via a web console`}</li>\n      <li parentName=\"ul\">{`Converting either a Protocol Buffers or JSON to and from an\n`}<a parentName=\"li\" {...{\n          \"href\": \"https://scalapb.github.io/docs/generated-code\"\n        }}>{`scalapb.GeneratedMessage`}</a>{` in annotated service`}</li>\n    </ul>\n    <p>{`First, you need the `}<inlineCode parentName=\"p\">{`armeria-scalapb_2.12`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`armeria-scalapb_2.13`}</inlineCode>{` dependency to use the above features:`}</p>\n    <CodeBlock language=\"groovy\" filename=\"build.sbt\" mdxType=\"CodeBlock\">{`\nlibraryDependencies += \"com.linecorp.armeria\" %% \"armeria-scalapb\" % \"${versions['com.linecorp.armeria:armeria-bom']}\"\n`}</CodeBlock>\n    <Tip mdxType=\"Tip\"> \n      <p><inlineCode parentName=\"p\">{`armeria-scalapb`}</inlineCode>{` is only available for Scala 2.12.x and 2.13.x.`}</p>\n    </Tip> \n    <h2 {...{\n      \"id\": \"running-a-grpc-service\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#running-a-grpc-service\",\n        \"aria-label\": \"running a grpc service permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Running a gRPC service`}</h2>\n    <p>{`You need to register a ScalaPB gRPC stub to a `}<a parentName=\"p\" {...{\n        \"href\": \"type://GrpcService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcService.html\"\n      }}>{`type://GrpcService`}</a>{` using a `}<a parentName=\"p\" {...{\n        \"href\": \"type://GrpcServiceBuilder:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcServiceBuilder.html\"\n      }}>{`type://GrpcServiceBuilder`}</a>{`\nand add it to the `}<a parentName=\"p\" {...{\n        \"href\": \"type://ServerBuilder:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html\"\n      }}>{`type://ServerBuilder`}</a>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-scala\"\n      }}>{`import com.linecorp.armeria.common.scalapb.ScalaPbJsonMarshaller\nimport com.linecorp.armeria.server.Server\nimport com.linecorp.armeria.server.docs.DocService\nimport com.linecorp.armeria.server.grpc.GrpcService\n\n// Creates GrpcService with your gRPC stub generated by ScalaPB.\nval grpcService =\n      GrpcService\n        .builder()\n        // Add your ScalaPB gRPC stub using \\`bindService()\\`\n        .addService(YourServiceGrpc.bindService(\n          new YourServiceImpl, ExecutionContext.global))\n        // Register \\`ScalaPbJsonMarshaller\\` for supporting gRPC JSON format.\n        .jsonMarshallerFactory(_ => ScalaPbJsonMarshaller())\n        .enableUnframedRequests(true)\n        .build()\n\n// Creates Armeria Server for ScalaPB gRPC stub.\nServer.builder()\n      .http(httpPort)\n      .https(httpsPort)\n      .service(grpcService)\n      // Add DocService for browsing the list of gRPC services and \n      // invoking a service operation from a web form.\n      // See https://armeria.dev/docs/server-docservice for more information.\n      .serviceUnder(\"/docs\", new DocService())\n      .build()\n`}</code></pre>\n    <p>{`Please see `}<a parentName=\"p\" {...{\n        \"href\": \"https://armeria.dev/docs/server-grpc\"\n      }}>{`gRPC service`}</a>{` for more information.`}</p>\n    <h2 {...{\n      \"id\": \"calling-a-grpc-service\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#calling-a-grpc-service\",\n        \"aria-label\": \"calling a grpc service permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Calling a gRPC service`}</h2>\n    <p>{`You can also call a gRPC service using a ScalaPB gRPC client.\n`}<inlineCode parentName=\"p\">{`ScalaPbJsonMarshaller`}</inlineCode>{` should be registered with `}<a parentName=\"p\" {...{\n        \"href\": \"type://GrpcClientBuilder#jsonMarshallerFactory(Function):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/grpc/GrpcClientBuilder.html#jsonMarshallerFactory(java.util.function.Function)\"\n      }}>{`type://GrpcClientBuilder#jsonMarshallerFactory(Function)`}</a>{` to\nsupport gRPC JSON serialization format.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-scala\"\n      }}>{`import com.linecorp.armeria.client.grpc.GrpcClients\nimport com.linecorp.armeria.common.grpc.GrpcSerializationFormats\nimport com.linecorp.armeria.common.scalapb.ScalaPbJsonMarshaller\n        \nval client = \n  GrpcClients.builder(\"http://127.0.0.1:8080/\")\n             .serializationFormat(GrpcSerializationFormats.JSON)\n             // Register 'ScalaPbJsonMarshaller' for enabling gRPC JSON serialization format\n             .jsonMarshallerFactory(_ => ScalaPbJsonMarshaller())\n             .build(classOf[HelloServiceBlockingStub])\n    \nval request = HelloRequest(\"Armerian World\")\nval reply = helloService.hello(request)\nassert(reply.message == \"Hello, Armerian World!\")\n`}</code></pre>\n    <p>{`Please see `}<a parentName=\"p\" {...{\n        \"href\": \"https://armeria.dev/docs/client-grpc\"\n      }}>{`gRPC client`}</a>{` for more information.`}</p>\n    <h2 {...{\n      \"id\": \"supporting-scalapb-in-annotated-services\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#supporting-scalapb-in-annotated-services\",\n        \"aria-label\": \"supporting scalapb in annotated services permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Supporting ScalaPB in annotated services.`}</h2>\n    <h3 {...{\n      \"id\": \"converting-an-http-request-to-a-scalapbs-generatedmesage\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h3\" {...{\n        \"href\": \"#converting-an-http-request-to-a-scalapbs-generatedmesage\",\n        \"aria-label\": \"converting an http request to a scalapbs generatedmesage permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Converting an HTTP request to a ScalaPB's `}<inlineCode parentName=\"h3\">{`GeneratedMesage`}</inlineCode></h3>\n    <ul>\n      <li parentName=\"ul\">{`A Protocol Buffers is automatically converted to a `}<inlineCode parentName=\"li\">{`GeneratedMessage`}</inlineCode>{` only when\nthe content type is one of followings:`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`application/probuf`}</inlineCode>{` `}</li>\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`application/octet-stream`}</inlineCode></li>\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`application/x-protobuf`}</inlineCode></li>\n          <li parentName=\"ul\">{`no media type negotiated`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">{`A JSON is automatically converted to a `}<inlineCode parentName=\"li\">{`GeneratedMessage`}</inlineCode>{` only when the content type\nis either `}<inlineCode parentName=\"li\">{`application/json`}</inlineCode>{` or ends with `}<inlineCode parentName=\"li\">{`+json`}</inlineCode>{`.`}</li>\n    </ul>\n    <p>{`If you have the following proto file,`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-protobuf\"\n      }}>{`syntax = \"proto3\";\npackage com.example.testing;\noption java_package = \"com.example.testing\";\n\nmessage SimpleRequest {\n  string payload = 1;\n  int32 size = 2;\n}\n\nmessage SimpleResponse {\n  string message = 1;\n  int32 status = 2;\n}\n`}</code></pre>\n    <p>{`the `}<inlineCode parentName=\"p\">{`SimpleRequest`}</inlineCode>{` generated by ScalaPB could be used for a parameter of your service method.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-scala\"\n      }}>{`import com.example.testing.SimpleRequest\nimport com.linecorp.armeria.server.annotation.{ConsumesJson, ConsumesProtobuf, Post}\n\nclass GreetingService {\n  // If a content type is not set, Protoco Buffers' parser is used by default.\n  @Post(\"/no-content-type\")\n  def noContentType(request: SimpleRequest): String = s\"Hello, \\${request.payload}!\"\n\n  // Convert the Protocol Buffers in an HTTP payload into the 'SimpleRequest'\n  @Post(\"/protobuf\")\n  @ConsumesProtobuf\n  def consumeProtobuf(request: SimpleRequest): String = s\"Hello, \\${request.payload}!\"\n\n  // Convert the JSON in an HTTP payload into a 'SimpleRequest'\n  @Post(\"/json\")\n  @ConsumesJson\n  def consumeJson(request: SimpleRequest): String = \"Hello, Armeria!\"\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"returning-a-scalapbs-generatedmesage\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h3\" {...{\n        \"href\": \"#returning-a-scalapbs-generatedmesage\",\n        \"aria-label\": \"returning a scalapbs generatedmesage permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Returning a ScalaPB's `}<inlineCode parentName=\"h3\">{`GeneratedMesage`}</inlineCode></h3>\n    <p>{`A `}<inlineCode parentName=\"p\">{`GeneratedMesage`}</inlineCode>{` can be converted to either Protocol Buffers or JSON.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-scala\"\n      }}>{`import com.example.testing.SimpleResponse\nimport scala.concurrent.Future\n\nclass GreetingService {\n\n  // Convert 'SimpleResponse' into Protocol Buffers wire format\n  @Get(\"/protobuf\")\n  @ProducesProtobuf\n  def produceProtobuf: SimpleResponse = SimpleResponse(\"Hello, Armeria!\")\n\n  // Convert 'SimpleResponse' into JSON format\n  @Get(\"/json\")\n  @ProducesJson\n  def produceJson: SimpleResponse = SimpleResponse(\"Hello, Armeria!\")\n\n  // Convert 'SimpleResponse' into Protocol Buffers wire format with Scala Future\n  @Get(\"/protobuf+async\")\n  @ProducesProtobuf\n  def produceProtobufFuture: Future[SimpleResponse] = \n    Future { SimpleResponse(\"Hello, Armeria!\") }\n}\n`}</code></pre>\n    <p>{`However, a sequence of `}<inlineCode parentName=\"p\">{`GeneratedMesage`}</inlineCode>{`s can be only converted to JSON array because Protocol Buffers\nwire format is `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/protocol-buffers/docs/techniques#streaming\"\n      }}>{`not self-delimiting`}</a>{`.\nThe following collection types can be converted to JSON array:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`scala.List`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`scala.Vector`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`scala.Set`}</inlineCode></li>\n      <li parentName=\"ul\">{`Reactive Stream `}<a parentName=\"li\" {...{\n          \"href\": \"https://www.reactive-streams.org/reactive-streams-1.0.2-javadoc/org/reactivestreams/Publisher.html\"\n        }}>{`Publisher`}</a></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`java.util.List`}</inlineCode>{` `}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`java.util.Set`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`java.util.stream.Stream`}</inlineCode></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"injecting-an-executioncontext-to-an-annotated-service-method\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h3\" {...{\n        \"href\": \"#injecting-an-executioncontext-to-an-annotated-service-method\",\n        \"aria-label\": \"injecting an executioncontext to an annotated service method permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Injecting an `}<a parentName=\"h3\" {...{\n        \"href\": \"https://www.scala-lang.org/api/current/scala/concurrent/ExecutionContext.html\"\n      }}>{`ExecutionContext`}</a>{` to an annotated service method`}</h3>\n    <p>{`An `}<inlineCode parentName=\"p\">{`ExecutionContext`}</inlineCode>{` could be automatically injected as a method parameter to execute an asynchronous service\non top of an Armeria's event loop or blocking task executor.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-scala\"\n      }}>{`import com.linecorp.armeria.server.ServiceRequestContext\nimport com.linecorp.armeria.server.annoation.Blocking\nimport scala.concurrent.Future\n\nclass MyAsyncService {\n  @Post(\"/async\")\n  def asyncService(req: SimpleRequest)(implicit ec: ExecutionContext): Future[String] =\n    Future {\n      // This callback will be executed in an Armeria's event loop\n      assert(ServiceRequestContext.current() != null)\n      \"Hello, Armeria!\"\n    }\n\n  @Blocking\n  @Post(\"/blocking-task\")\n  def blockingAsyncService(req: SimpleRequest)(implicit ec: ExecutionContext): Future[String] =\n    Future {\n      // This callback will be executed in an Armeria's blocking task executor\n      assert(ServiceRequestContext.current() != null)\n      // Perform a long running task\n      \"Hello, Armeria!\"\n    }\n  }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","import { RouteComponentProps } from '@reach/router';\nimport { graphql, useStaticQuery } from 'gatsby';\nimport React from 'react';\n\nimport docsIndex from '../pages/docs/toc.json';\nimport MdxLayout from './mdx';\n\ninterface DocsLayoutProps extends RouteComponentProps {\n  pageContext: any;\n  pageTitle: string;\n}\n\nconst DocsLayout: React.FC<DocsLayoutProps> = (props) => {\n  const {\n    allMdx: { nodes: candidateMdxNodes },\n  } = useStaticQuery(graphql`\n    query {\n      allMdx(filter: { fileAbsolutePath: { glob: \"**/src/pages/docs/**\" } }) {\n        nodes {\n          tableOfContents(maxDepth: 1)\n          excerpt(pruneLength: 256, truncate: true)\n          parent {\n            ... on File {\n              sourceInstanceName\n              name\n            }\n          }\n        }\n      }\n    }\n  `);\n\n  return (\n    <MdxLayout\n      {...props}\n      candidateMdxNodes={candidateMdxNodes}\n      index={docsIndex}\n      prefix=\"docs\"\n      pageTitleSuffix=\"Armeria documentation\"\n    />\n  );\n};\n\nexport default DocsLayout;\n"],"names":["pageTitle","_frontmatter","makeShortcode","name","props","console","warn","Tip","CodeBlock","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","language","filename","versions","isMDXComponent","candidateMdxNodes","useStaticQuery","allMdx","nodes","index","docsIndex","prefix","pageTitleSuffix"],"sourceRoot":""}